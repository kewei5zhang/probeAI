# Trading AI Assistant - Cursor Rules

## Project Overview
A Chrome extension that provides AI-powered trading analysis for TradingView charts. The extension captures screenshots and uses OpenAI/Grok vision models to provide technical analysis insights.

## Architecture
The codebase is modularized into focused files to reduce AI context costs and improve maintainability:

### Core Files & When to Read Them

**ğŸ“± UI Changes & Layout Issues**
- `ui-builder.js` - Main UI creation, HTML templates, modal generation
- `styles.css` - All styling, responsive design, animations
- Read for: Layout bugs, styling issues, new UI components, modal problems

**ğŸ¤– AI Provider & Analysis Issues**  
- `ai-provider.js` - AI API calls, provider switching, model configuration
- Read for: API errors, provider switching, model selection, analysis problems

**ğŸ’¬ Chat & Messaging Features**
- `chat-manager.js` - Message handling, conversation flow, formatting
- Read for: Chat functionality, message display, conversation history

**ğŸ“¸ Screenshot & Gallery Management**
- `screenshot-manager.js` - Screenshot capture, gallery, multi-timeframe storage
- Read for: Screenshot issues, gallery problems, timeframe management

**âš™ï¸ Settings & Configuration**
- `settings-modal.js` - Settings UI, provider configuration, API key management  
- Read for: Settings modal issues, provider toggles, API key problems

**ğŸ¯ User Interactions & Events**
- `event-handlers.js` - Event listeners, drag/resize, button clicks
- Read for: Interaction bugs, event handling, drag/resize issues

**ğŸ”§ Utilities & Helpers**
- `utils.js` - Common functions, formatters, memory management
- Read for: Formatting issues, utility functions, memory problems

**ğŸš€ Main Entry Point**
- `content.js` - Core class, initialization, coordination between modules
- Read for: Initialization issues, module coordination, core logic

**ğŸ“‹ Extension Configuration**
- `manifest.json` - Chrome extension permissions, content scripts
- `background.js` - Service worker, screenshot capture
- Read for: Permission issues, extension loading problems

## File Reading Strategy

### ğŸ¯ For Specific Issues:
**"Copy button not working"** â†’ Read: `chat-manager.js`, `utils.js`
**"Settings modal broken"** â†’ Read: `settings-modal.js`, `ui-builder.js`  
**"AI provider switching failed"** â†’ Read: `ai-provider.js`, `settings-modal.js`
**"Gallery not showing screenshots"** â†’ Read: `screenshot-manager.js`, `ui-builder.js`
**"Drag and drop broken"** â†’ Read: `event-handlers.js`, `styles.css`
**"Chat window styling weird"** â†’ Read: `styles.css`, `ui-builder.js`

### ğŸ” For Feature Areas:
**Chat System** â†’ `chat-manager.js` + `utils.js`
**Settings/Configuration** â†’ `settings-modal.js` + `ai-provider.js`
**Screenshot System** â†’ `screenshot-manager.js` + `background.js`
**UI/Styling** â†’ `ui-builder.js` + `styles.css`
**AI Integration** â†’ `ai-provider.js` + `utils.js`

### ğŸ“¦ Module Dependencies:
- `content.js` imports and coordinates all other modules
- `ui-builder.js` imports from `utils.js`
- `ai-provider.js` imports from `utils.js`  
- `chat-manager.js` imports from `utils.js`
- Other modules are standalone

## Coding Guidelines

### ğŸ—ï¸ Architecture Principles:
- Each module has a single, focused responsibility
- Use ES6 imports/exports for module communication
- Keep utilities pure and reusable
- Maintain clear separation between UI and logic

### ğŸ“ Documentation:
- All modules have JSDoc headers explaining purpose and context
- Functions include parameter and return type documentation
- Use descriptive variable and function names

### ğŸ¨ UI Development:
- All HTML generation happens in `ui-builder.js`
- CSS changes go in `styles.css` only
- Use consistent naming conventions for CSS classes

### ğŸ”§ Debugging:
- Console logs include emoji prefixes for easy filtering
- Error handling includes context about which module failed
- Use meaningful error messages that help identify the issue

## Quick Reference

**Adding new UI element** â†’ Modify `ui-builder.js`
**Fixing AI API call** â†’ Check `ai-provider.js`  
**Changing message format** â†’ Update `chat-manager.js`
**Adding screenshot feature** â†’ Extend `screenshot-manager.js`
**New settings option** â†’ Update `settings-modal.js`
**Event listener issue** â†’ Check `event-handlers.js`
**Utility function needed** â†’ Add to `utils.js`

## Performance Notes
- Each module is ~200-400 lines vs original 2000+ line monolith
- AI context costs reduced by 70-80% when reading specific files
- Modules can be read independently for focused changes
- Only read `content.js` for initialization or coordination issues 